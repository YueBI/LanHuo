{"remainingRequest":"/Users/biyue/Documents/LanHuo/LanHuo-biyue/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/biyue/Documents/LanHuo/LanHuo-biyue/src/views/subway/InfoCard.vue?vue&type=script&lang=js&","dependencies":[{"path":"/Users/biyue/Documents/LanHuo/LanHuo-biyue/src/views/subway/InfoCard.vue","mtime":1562858700000},{"path":"/Users/biyue/Documents/LanHuo/LanHuo-biyue/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/biyue/Documents/LanHuo/LanHuo-biyue/node_modules/@vue/cli-plugin-babel/node_modules/babel-loader/lib/index.js","mtime":499162500000},{"path":"/Users/biyue/Documents/LanHuo/LanHuo-biyue/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/biyue/Documents/LanHuo/LanHuo-biyue/node_modules/vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":["//\n//\n//\n//\n//\n//\n//\n//\n\nimport echarts from \"echarts\";\nimport { setInterval } from \"timers\";\n\nexport default {\n  name: \"InfoCard\",\n  props: {\n    infoCard: Object\n  },\n  data() {\n    return {};\n  },\n  methods: {\n    update_option(chart, app) {\n      // console.log(this.infoCard);\n      let axisData = new Date().toLocaleTimeString().replace(/^\\D*/, \"\");\n      let data0 = this.infoCard.option.series[0].data;\n      let data1 = this.infoCard.option.series[1].data;\n      data0.shift();\n      let new_input = Math.round(Math.random() * 1000);\n      data0.push(new_input);\n      data1.shift();\n      data1.push((Math.random() * 10 + 5).toFixed(1) - 0);\n\n      this.infoCard.option.xAxis[0].data.shift();\n      this.infoCard.option.xAxis[0].data.push(axisData);\n      this.infoCard.option.xAxis[1].data.shift();\n      this.infoCard.option.xAxis[1].data.push(app.count++);\n      chart.setOption(this.infoCard.option);\n      this.infoCard.number = String(new_input / 10) + \"%\";\n    },\n    update_user_option(chart) {\n      this.infoCard.option.series[0].data[0].value =\n        (Math.random() * 100).toFixed(2) - 0;\n      chart.setOption(this.infoCard.option, true);\n    },\n    random(maxData) {\n      return +(Math.random() * (maxData - 10)).toFixed(1);\n    },\n    update_queued_option(chart, maxData) {\n      let dynamicData = [\n        this.random(maxData),\n        this.random(maxData),\n        this.random(maxData),\n        this.random(maxData)\n      ];\n      this.infoCard.option.series[0].data = dynamicData.slice();\n      this.infoCard.option.series[1].data = dynamicData.slice();\n      chart.setOption(this.infoCard.option);\n    },\n    update_average_density_number() {\n      this.infoCard.number = String(Math.round(Math.random() * 1000)) + \"人/时\";\n    }\n  },\n  mounted() {\n    let app = {};\n    app.count = 11;\n    var that = this;\n    window.addEventListener(\"message\", function(e) {\n      if (e.source === window.frames[0] || !isNaN(e.data)) {\n        // console.log(\"testsssss\");\n        console.log(e.data);\n        let name = that.infoCard.name;\n        switch (name) {\n          case \"averageFlow\":\n            if (typeof(e.data)=='string') {\n              that.infoCard.title = e.data + that.infoCard.title.slice(-6);\n            }\n            that.update_average_density_number();\n            break;\n          case \"CurrentDensity\":\n            if (typeof(e.data)=='string') {\n              that.infoCard.title = e.data + that.infoCard.title.slice(-5);\n            }\n            break;\n          case \"passengerFlow\":\n           if (typeof(e.data)=='string') {\n              that.infoCard.title = e.data + that.infoCard.title.slice(-5);\n            }\n            let overall_number = Math.round(Math.random() * 10000);\n            that.infoCard.number = overall_number;\n            that.infoCard.option.series[0].data = Array.from(\n              { length: 7 },\n              () => Math.floor(Math.random() * 1000 + 500)\n            );\n            chart.setOption(that.infoCard.option, true);\n            break;\n          case \"WaitingComfortDegree\":\n            let number = Math.round(Math.random() * 100).toFixed(0);\n            that.infoCard.number = String(number) + \"%\";\n            that.infoCard.option.series[0].data[0].value = number - 0;\n            // console.log(that.infoCard.option);\n            chart.setOption(that.infoCard.option, true);\n            break;\n          case \"CongestionDegree\":\n            // let station_id_map = JSON.parse(\n            //   localStorage.getItem(\"station_id_map\")\n            // );\n            // let id = station_id_map[e.data];\n            // console.log(\"id:\" + String(id));\n            let busy_number = Math.round(Math.random() * 100);\n            let free_number = Math.round(Math.random() * 100);\n            that.infoCard.option.series[0].data[0].value = free_number;\n            that.infoCard.option.series[0].data[1].value = busy_number;\n            that.infoCard.number = \"⭐\".repeat(\n              Math.floor((free_number / (free_number + busy_number)) * 5) + 1\n            );\n            // console.log(that.infoCard.option);\n            chart.setOption(that.infoCard.option, true);\n            break;\n        }\n      }\n    });\n    let chart = echarts.init(\n      document.getElementById(this.infoCard.name),\n      \"macarons\"\n    );\n    if (this.infoCard.name === \"CurrentDensity\") {\n      chart.setOption(this.infoCard.option);\n      setInterval(this.update_option, 3000, chart, app);\n      // var that = this;\n      // window.addEventListener(\"message\", function(e) {\n      //   if (e.source === window.frames[0]) {\n      // let station_id_map = JSON.parse(\n      //   localStorage.getItem(\"station_id_map\")\n      // );\n      // let id = station_id_map[e.data];\n      // console.log(\"test\" + e.data);\n\n      // let busy_number = Math.round(Math.random() * 100);\n      // let free_number = Math.round(Math.random() * 100);\n\n      // that.infoCard.title = e.data + that.infoCard.title.slice(-5);\n      // that.infoCard.option.series[0].data[1].value = busy_number;\n      // that.infoCard.number = \"⭐\".repeat(\n      //   Math.floor((free_number / (free_number + busy_number)) * 5) + 1\n      // );\n      // console.log(that.infoCard.option);\n      //   chart.setOption(that.infoCard.option, true);\n      // }\n      // });\n    } else if (this.infoCard.name === \"QueueNumber\") {\n      chart.setOption(this.infoCard.option);\n      setInterval(\n        this.update_queued_option,\n        3000,\n        chart,\n        this.infoCard.maxData\n      );\n    } else {\n      chart.setOption(this.infoCard.option);\n    }\n  },\n  computed: {\n    number: function() {\n      return this.infoCard.number;\n    }\n  }\n};\n",null]}