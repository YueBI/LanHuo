{"remainingRequest":"/Users/biyue/Documents/LanHuo/LanHuo-biyue/node_modules/@vue/cli-plugin-babel/node_modules/babel-loader/lib/index.js!/Users/biyue/Documents/LanHuo/LanHuo-biyue/node_modules/cache-loader/dist/cjs.js??ref--0-0!/Users/biyue/Documents/LanHuo/LanHuo-biyue/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/biyue/Documents/LanHuo/LanHuo-biyue/src/views/nested/fenceMana/index.vue?vue&type=script&lang=js&","dependencies":[{"path":"/Users/biyue/Documents/LanHuo/LanHuo-biyue/src/views/nested/fenceMana/index.vue","mtime":1560229563318},{"path":"/Users/biyue/Documents/LanHuo/LanHuo-biyue/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/biyue/Documents/LanHuo/LanHuo-biyue/node_modules/@vue/cli-plugin-babel/node_modules/babel-loader/lib/index.js","mtime":499162500000},{"path":"/Users/biyue/Documents/LanHuo/LanHuo-biyue/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/biyue/Documents/LanHuo/LanHuo-biyue/node_modules/vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":["\"use strict\";\n\nvar _interopRequireDefault = require(\"/Users/biyue/Documents/LanHuo/LanHuo-biyue/node_modules/@babel/runtime-corejs2/helpers/interopRequireDefault\");\n\nvar _Object$defineProperty = require(\"/Users/biyue/Documents/LanHuo/LanHuo-biyue/node_modules/@babel/runtime-corejs2/core-js/object/define-property\");\n\n_Object$defineProperty(exports, \"__esModule\", {\n  value: true\n});\n\nexports.default = void 0;\n\nvar _parseInt2 = _interopRequireDefault(require(\"/Users/biyue/Documents/LanHuo/LanHuo-biyue/node_modules/@babel/runtime-corejs2/core-js/parse-int\"));\n\nvar _api = _interopRequireDefault(require(\"@/api/hardware/api.js\"));\n\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n// import '../../static/css/gateMana/common.css'\n// import '../../static/css/gateMana/dianziweilan.css'\nvar _default = {\n  data: function data() {\n    return {\n      testData: [],\n      filterFormFro: {\n        tableData: [],\n        totalCount: 0\n      },\n      filterForm: {\n        queryCondition: '0',\n        queryContent: '',\n        currentPage: 1\n      },\n      tableWidth: '',\n      // 表格宽度\n      loadingText: '正在拼命加载中，请稍等......',\n      loading: false,\n      paginationVisible: true,\n      // 表格下方的分页显示\n      formLabelWidth: '150px',\n      editVisable: false,\n      editForm: {\n        fenceName: '',\n        fenceDes: '',\n        groupName: '',\n        conditionName: '',\n        alarmName: '',\n        effectiveTime: '',\n        adminName: ''\n      },\n      deleteForm: {\n        fenceId: ''\n      },\n      states: [],\n      conditionOptions: [],\n      alarmOptions: [],\n      options: [{\n        value: '0',\n        label: '无查询条件'\n      }, {\n        value: '1',\n        label: '所属楼名称'\n      }, {\n        value: '2',\n        label: '所属组名称'\n      }],\n      withCredentials: true,\n      processing: false,\n      uploadTip: '点击上传',\n      importFlag: 1,\n      dialogImportVisible: false,\n      errorResults: [],\n      pickerOptions: {\n        shortcuts: [{\n          text: '最近一周',\n          onClick: function onClick(picker) {\n            var end = new Date();\n            var start = new Date();\n            start.setTime(start.getTime() - 3600 * 1000 * 24 * 7);\n            picker.$emit('pick', [start, end]);\n          }\n        }, {\n          text: '最近一个月',\n          onClick: function onClick(picker) {\n            var end = new Date();\n            var start = new Date();\n            start.setTime(start.getTime() - 3600 * 1000 * 24 * 30);\n            picker.$emit('pick', [start, end]);\n          }\n        }, {\n          text: '最近三个月',\n          onClick: function onClick(picker) {\n            var end = new Date();\n            var start = new Date();\n            start.setTime(start.getTime() - 3600 * 1000 * 24 * 90);\n            picker.$emit('pick', [start, end]);\n          }\n        }]\n      }\n    };\n  },\n  created: function created() {\n    this.getFenceFro();\n  },\n  mounted: function mounted() {\n    this.tableWidth = document.body.scrollWidth - 259 - 20;\n  },\n  methods: {\n    /** ********************************* 页面处理数据格式等函数 ************************************************ */\n    // 点击表格中的“编辑”按钮\n    // 分页页面跳转时\n    handleCurrentChange: function handleCurrentChange(val) {\n      this.filterForm.currentPage = val;\n      this.getFenceFro(this.filterForm.currentPage);\n    },\n    // 设置表头样式\n    tableHeaderClassName: function tableHeaderClassName(_ref) {\n      var row = _ref.row,\n          column = _ref.column,\n          rowIndex = _ref.rowIndex,\n          columnIndex = _ref.columnIndex;\n\n      if (rowIndex === 0) {\n        return 'headerClass';\n      }\n    },\n    // 设置表格每一行样式\n    tableRowClassName: function tableRowClassName(_ref2) {\n      var row = _ref2.row,\n          rowIndex = _ref2.rowIndex;\n      return 'rowClass';\n    },\n    handleEdit: function handleEdit(index, row) {\n      var data = this.filterFormFro.tableData[index];\n      this.editForm.fenceName = row.fenceName;\n      this.editForm.oldFenceName = data.fenceName;\n      this.editForm.fenceDes = row.fenceName;\n      this.editForm.groupName = row.groupName;\n      this.editForm.conditionName = row.conditionName;\n      this.editForm.alarmName = row.alarmName;\n      this.editForm.effectiveTime = row.effectiveTime;\n      this.editForm.adminName = row.adminName;\n      this.editVisable = true;\n    },\n    // 点击表格中的“删除”按钮\n    handleDelete: function handleDelete(index, row) {\n      var _this = this;\n\n      // let data = this.filterFormFro.tableData[index]\n      this.deleteForm.fenceId = row.fenceId;\n      this.$confirm('确定删除该信息吗?', '提示', {\n        confirmButtonText: '确定',\n        cancelButtonText: '取消',\n        type: 'warning'\n      }).then(function () {\n        _this.deleteFenceFro();\n      }).catch(function () {\n        _this.$message({\n          type: 'info',\n          message: '已取消删除'\n        });\n      });\n    },\n    handleInfo: function handleInfo(index, row) {\n      var data = this.filterFormFro.tableData[index];\n      this.$router.push({\n        name: 'alarmMana',\n        query: {\n          fenceId: data.fenceId,\n          fenceName: row.fenceName\n        }\n      });\n    },\n    // 编辑围栏信息，点击“保存”\n    submitEdit: function submitEdit() {\n      var _this2 = this;\n\n      this.$refs['editForm'].validate(function (valid) {\n        if (valid) {\n          _this2.editFenceFro();\n        } else {\n          return false;\n        }\n      });\n    },\n    // 将时间转化为字符串(filterForm)\n    formatDayFro: function formatDayFro(now) {\n      var year = now.getFullYear();\n      var month = now.getMonth() + 1;\n      month = month < 10 ? '0' + month : month;\n      var date = now.getDate();\n      date = date < 10 ? '0' + date : date;\n      var hour = now.getHours();\n      hour = hour < 10 ? '0' + hour : hour;\n      var minute = now.getMinutes();\n      minute = minute < 10 ? '0' + minute : minute;\n      var second = now.getSeconds();\n      second = second < 10 ? '0' + second : second;\n      return year + '-' + month + '-' + date + ' ' + hour + ':' + minute + ':' + second;\n    },\n    // 触发条件下拉列表\n    conditionRemoteMethod: function conditionRemoteMethod(query) {\n      var _this3 = this;\n\n      if (query !== '') {\n        _api.default.getAllCondition({}).then(function (res) {\n          if (res.result === 1000) {\n            var data = res.content;\n\n            if (data.list.length > 0) {\n              _this3.conditionOptions = data.list;\n            }\n          }\n        });\n      }\n    },\n    // 警报下拉列表\n    alarmRemoteMethod: function alarmRemoteMethod(query) {\n      var _this4 = this;\n\n      if (query !== '') {\n        _api.default.getAllAlarm({}).then(function (res) {\n          if (res.result === 1000) {\n            var data = res.content;\n\n            if (data.list.length > 0) {\n              _this4.alarmOptions = data.list;\n            }\n          }\n        });\n      }\n    },\n    // 查询信息\n    getFenceFro: function getFenceFro(pageNum) {\n      var _this5 = this;\n\n      this.loading = true;\n      var para = {\n        pageSize: 15,\n        pageNum: (0, _parseInt2.default)(this.filterForm.currentPage),\n        buildName: '学五',\n        groupName: ''\n      };\n\n      if (this.filterForm.queryCondition !== '0' && this.filterForm.queryContent !== '') {\n        if (this.filterForm.queryCondition === '1') {\n          para.buildName = this.filterForm.queryContent;\n        } else {\n          para.groupName = this.filterForm.queryContent;\n        }\n      } else {\n        para.buildName = '';\n        para.groupName = '';\n      }\n\n      pageNum ? this.filterForm.currentPage = pageNum : this.filterForm.currentPage = 1;\n      console.log('Here is para:');\n      console.log(para);\n\n      _api.default.getFence(para).then(function (res) {\n        _this5.filterFormFro.tableData = [];\n        _this5.loading = false;\n\n        if (res.result === 1000) {\n          console.log('Here is res:');\n          console.log(res);\n          var data = res.content;\n          data.allPages > 0 ? _this5.paginationVisible = true : _this5.paginationVisible = false;\n\n          if (data.list.length > 0) {\n            // this.filterFormFro.totalCount = data.allCount\n            _this5.filterFormFro.tableData = data.list;\n\n            for (var i = 0; i < _this5.filterFormFro.tableData.length; i++) {\n              _this5.filterFormFro.tableData[i].index = (_this5.filterForm.currentPage - 1) * 15 + i + 1;\n            }\n\n            console.log('查到了信息');\n          } else {\n            _this5.$message.warning('没有查到任何信息');\n\n            console.log('没有查到任何信息');\n          }\n        } else {\n          console.log('Here comes to non 1000 response');\n\n          _this5.$message.error(res.resultDesp);\n        }\n      }).catch(function (error) {\n        console.log('Here comes to error response');\n        _this5.loading = false;\n\n        _this5.$message.error(error);\n\n        console.log(error);\n      });\n    },\n    // 硬件信息-编辑围栏信息\n    editFenceFro: function editFenceFro() {\n      var _this6 = this;\n\n      var para = {\n        fenceName: this.editForm.fenceName,\n        oldFenceName: this.editForm.oldFenceName,\n        fenceDes: this.editForm.fenceDes,\n        groupName: this.editForm.groupName,\n        conditionName: this.editForm.conditionName,\n        alarmName: this.editForm.alarmName,\n        effectiveTime: this.editForm.effectiveTime,\n        adminName: this.editForm.adminName\n      };\n\n      for (var i = 0; i < this.conditionOptions.length; i++) {\n        if (this.editForm.conditionName === this.conditionOptions[i].conditionName) {\n          para.conditionId = (0, _parseInt2.default)(this.conditionOptions[i].conditionId);\n          break;\n        }\n      }\n\n      for (var _i = 0; _i < this.alarmOptions.length; _i++) {\n        if (this.editForm.conditionName === this.alarmOptions[_i].conditionName) {\n          para.alarmId = (0, _parseInt2.default)(this.alarmOptions[_i].alarmId);\n          break;\n        }\n      }\n\n      _api.default.editFence(para).then(function (res) {\n        if (res.result === 1000) {\n          _this6.editVisable = false;\n\n          _this6.$message.success('编辑围栏信息成功');\n\n          _this6.getFenceFro();\n        } else {\n          _this6.$message.warning(res.resultDesp);\n        }\n      }).catch(function (error) {\n        _this6.editVisable = false;\n\n        _this6.$message.error(error);\n      });\n    },\n    // 删除围栏信息\n    deleteFenceFro: function deleteFenceFro() {\n      var _this7 = this;\n\n      var para = {\n        fenceId: (0, _parseInt2.default)(this.deleteForm.fenceId)\n      };\n\n      _api.default.deleteFence(para).then(function (res) {\n        if (res.result === 1000) {\n          _this7.deleteVisable = false;\n\n          _this7.$message.success('删除成功');\n\n          _this7.getFenceFro();\n        } else {\n          _this7.$message.warning(res.resultDesp);\n        }\n      }).catch(function (error) {\n        _this7.deleteVisable = false;\n\n        _this7.$message.error(error);\n      });\n    }\n  }\n};\nexports.default = _default;",null]}